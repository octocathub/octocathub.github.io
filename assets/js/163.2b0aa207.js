(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{583:function(t,n,s){"use strict";s.r(n);var e=s(13),a=Object(e.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"systemd-è¿›ç¨‹ç®¡ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#systemd-è¿›ç¨‹ç®¡ç†"}},[t._v("#")]),t._v(" Systemd è¿›ç¨‹ç®¡ç†")]),t._v(" "),s("h2",{attrs:{id:"systemd-ä»‹ç»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#systemd-ä»‹ç»"}},[t._v("#")]),t._v(" systemd ä»‹ç»")]),t._v(" "),s("p",[t._v("systemdæ˜¯ç›®å‰Linuxç³»ç»Ÿä¸Šä¸»è¦çš„ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œç”±äºŽinitä¸€æ–¹é¢å¯¹äºŽè¿›ç¨‹çš„ç®¡ç†æ˜¯ä¸²è¡ŒåŒ–çš„ï¼Œå®¹æ˜“å‡ºçŽ°é˜»å¡žæƒ…å†µï¼Œå¦ä¸€æ–¹é¢initä¹Ÿä»…ä»…æ˜¯æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼Œå¹¶ä¸èƒ½å¯¹æœåŠ¡æœ¬èº«è¿›è¡Œæ›´å¤šçš„ç®¡ç†ã€‚æ‰€ä»¥ä»ŽCentOS 7å¼€å§‹ä¹Ÿç”±systemdå–ä»£äº†initä½œä¸ºé»˜è®¤çš„ç³»ç»Ÿè¿›ç¨‹ç®¡ç†å·¥å…·ã€‚")]),t._v(" "),s("p",[t._v("systemdæ‰€ç®¡ç†çš„æ‰€æœ‰ç³»ç»Ÿèµ„æºéƒ½ç§°ä½œUnitï¼Œé€šè¿‡systemdå‘½ä»¤é›†å¯ä»¥æ–¹ä¾¿çš„å¯¹è¿™äº›Unitè¿›è¡Œç®¡ç†ã€‚æ¯”å¦‚systemctlã€hostnamectlã€timedatectlã€localctlç­‰å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤è™½ç„¶æ”¹å†™äº†initæ—¶ä»£ç”¨æˆ·çš„å‘½ä»¤ä½¿ç”¨ä¹ æƒ¯ï¼ˆä¸å†ä½¿ç”¨chkconfigã€serviceç­‰å‘½ä»¤ï¼‰ï¼Œä½†ç¡®å®žä¹Ÿæä¾›äº†å¾ˆå¤§çš„ä¾¿æ·æ€§ã€‚\nsystemd ç‰¹ç‚¹\næœ€æ–°ç³»ç»Ÿéƒ½é‡‡ç”¨systemdç®¡ç†ï¼ˆRedHat7ï¼ŒCentOS7ï¼ŒUbuntu15â€¦ï¼‰\nCentOS7 æ”¯æŒå¼€æœºå¹¶è¡Œå¯åŠ¨æœåŠ¡ï¼Œæ˜¾è‘—æé«˜å¼€æœºå¯åŠ¨æ•ˆçŽ‡\nCentOS7å…³æœºåªå…³é—­æ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼Œè€ŒCentOS6ï¼Œå…¨éƒ¨éƒ½å…³é—­ä¸€æ¬¡ã€‚\nCentOS7æœåŠ¡çš„å¯åŠ¨ä¸Žåœæ­¢ä¸å†ä½¿ç”¨è„šæœ¬è¿›è¡Œç®¡ç†ï¼Œä¹Ÿå°±æ˜¯/etc/init.dä¸‹ä¸åœ¨æœ‰è„šæœ¬ã€‚\nCentOS7ä½¿ç”¨systemdè§£å†³åŽŸæœ‰æ¨¡å¼ç¼ºé™·ï¼Œæ¯”å¦‚åŽŸæœ‰serviceä¸ä¼šå…³é—­ç¨‹åºäº§ç”Ÿçš„å­è¿›ç¨‹ã€‚\nsystemd è¯­æ³•\nsystemctl [command]      [unit]ï¼ˆé…ç½®çš„åº”ç”¨åç§°ï¼‰")]),t._v(" "),s("p",[t._v("commandå¯é€‰é¡¹\nÂ· startï¼šå¯åŠ¨æŒ‡å®šçš„unit          systemctl start nginx\nÂ· stopï¼šå…³é—­æŒ‡å®šçš„unit           systemctl stop nginx\nÂ· restartï¼šé‡å¯æŒ‡å®šunit          systemctl restart nginx\nÂ· reloadï¼šé‡è½½æŒ‡å®šunit           systemctl reload nginx\nÂ· enableï¼šç³»ç»Ÿå¼€æœºæ—¶è‡ªåŠ¨å¯åŠ¨æŒ‡å®šunitï¼Œå‰ææ˜¯é…ç½®æ–‡ä»¶ä¸­æœ‰ç›¸å…³é…ç½® systemctl enable nginx\nÂ· disableï¼šå¼€æœºæ—¶ä¸è‡ªåŠ¨è¿è¡ŒæŒ‡å®šunit   systemctl disable nginx\nÂ· statusï¼šæŸ¥çœ‹æŒ‡å®šunitå½“å‰è¿è¡ŒçŠ¶æ€ systemctl status nginx\nsystemd é…ç½®æ–‡ä»¶è¯´æ˜Ž\næ¯ä¸€ä¸ª Unit éƒ½éœ€è¦æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ç”¨äºŽå‘ŠçŸ¥ systemd å¯¹äºŽæœåŠ¡çš„ç®¡ç†æ–¹å¼\né…ç½®æ–‡ä»¶å­˜æ”¾äºŽ /usr/lib/systemd/system/ï¼Œè®¾ç½®å¼€æœºå¯åŠ¨åŽä¼šåœ¨ /etc/systemd/system ç›®å½•å»ºç«‹è½¯é“¾æŽ¥æ–‡ä»¶\næ¯ä¸ªUnitçš„é…ç½®æ–‡ä»¶é…ç½®é»˜è®¤åŽç¼€åä¸º.service\nåœ¨ /usr/lib/systemd/system/ ç›®å½•ä¸­åˆ†ä¸º system å’Œ user ä¸¤ä¸ªç›®å½•ï¼Œä¸€èˆ¬å°†å¼€æœºä¸ç™»é™†å°±èƒ½è¿è¡Œçš„ç¨‹åºå­˜åœ¨ç³»ç»ŸæœåŠ¡é‡Œï¼Œä¹Ÿå°±æ˜¯ /usr/lib/systemd/system\né…ç½®æ–‡ä»¶ä½¿ç”¨æ–¹æ‹¬å·åˆ†æˆäº†å¤šä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”åŒºåˆ†å¤§å°å†™\nsystemd ç›¸å…³æ–‡ä»¶\nå®žæˆ˜ä¸€\næºç ç¼–è¯‘å®‰è£…nginx å®žçŽ°systemdç®¡ç†æŽ§åˆ¶\nå®‰è£…nginxç¼–è¯‘çŽ¯å¢ƒ\nyum  -y install gcc gcc-c++    openssl-devel pcre-devel gd-devel  iproute net-tools telnet wget curl\nwget http://nginx.org/download/nginx-1.15.5.tar.gz\ntar zxf nginx-1.15.5.tar.gz &&\ncd nginx-1.15.5\n./configure --prefix=/usr/local/nginx "),s("br"),t._v("\n--with-http_ssl_module "),s("br"),t._v("\n--with-http_stub_status_module\nmake -j 4 && make install\né€šç”¨æ–¹å¼å¯åŠ¨nginx")]),t._v(" "),s("p",[t._v("/usr/local/nginx/sbin/nginx  #å¯åŠ¨\n/usr/local/nginx/sbin/nginx  -s reload  #é‡å¯\n/usr/local/nginx/sbin/nginx -s   quit   #å…³é—­nginx\nsystemd ç®¡ç†æŽ§åˆ¶å¯åŠ¨æ¨¡å¼")]),t._v(" "),s("p",[t._v("vim      /usr/lib/systemd/system/nginx.service")]),t._v(" "),s("p",[t._v("[Unit]\nDescription=nginx\nAfter=network.target")]),t._v(" "),s("p",[t._v("[Service]\nType=forking\nExecStart=/usr/local/nginx/sbin/nginx\nExecReload=/usr/local/nginx/sbin/nginx -s reload\nExecStop=/usr/local/nginx/sbin/nginx -s quit\nPrivateTmp=true")]),t._v(" "),s("p",[t._v("[Install]\nWantedBy=multi-user.target\nå‚æ•°è¯¦è§£")]),t._v(" "),s("p",[t._v("systemctl restart nginx\nsystemctl enable  nginx\nsystemctl stop  nginx\nå›¾ç‰‡")]),t._v(" "),s("p",[t._v("å®žæˆ˜äºŒ\näºŒè¿›åˆ¶å®‰è£…tomcat å®žçŽ°systemdç®¡ç†æŽ§åˆ¶")]),t._v(" "),s("p",[t._v("å®‰è£…javaçŽ¯å¢ƒï¼Œæˆ‘å·²ç»å°†å®‰è£…åŒ…æ‰“åŒ…åˆ°æˆ‘å¾—æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿå¯ä»¥åŽ»å®˜ç½‘ä¸‹è½½")]),t._v(" "),s("p",[t._v("wget  120.78.77.38/file/jdk-8u231-linux-x64.rpm\nwget  120.78.77.38/file/apache-tomcat-9.0.27.tar.gz\nå›¾ç‰‡\nrpm -ivh  jdk-8u231-linux-x64.rpm    #rpmç›´æŽ¥å®‰è£…jdk\né…ç½®çŽ¯å¢ƒå˜é‡")]),t._v(" "),s("p",[t._v("vim    /etc/profile")]),t._v(" "),s("p",[t._v("export JAVA_HOME=/usr/java/jdk1.8.0_231-amd64\nexport JRE_HOME=${JAVA_HOME}/jre"),s("br"),t._v("\nexport CLASSPATH=.ðŸ˜’{JAVA_HOME}/lib:${JRE_HOME}/lib"),s("br"),t._v("\nexport JAVA_PATH=${JAVA_HOME}/bin:${JRE_HOME}/bin\nexport  PATH=${JAVA_HOME}/bin:$PATH\nsource   /etc/profile\njava -version   #æ£€æµ‹çŽ¯å¢ƒ\nå›¾ç‰‡")]),t._v(" "),s("p",[t._v("å®‰è£…tomcat")]),t._v(" "),s("p",[t._v("tar  -xf  apache-tomcat-9.0.27"),s("br"),t._v("\nmv  apache-tomcat-9.0.27  /usr/local/tomcat\nå¯åŠ¨tomcat\nsh    /usr/local/tomcat/bin/startup.sh   #å¯åŠ¨\nsh   /usr/local/tomcat/bin/shutdown.sh #å…³é—­\nsystemdç®¡ç†æŽ§åˆ¶å¯åŠ¨")]),t._v(" "),s("p",[t._v("vim      /usr/lib/systemd/system/tomcat.service")]),t._v(" "),s("p",[t._v("[Unit]\nDescription=tomcat server\nWants=network-online.target\nAfter=network.target")]),t._v(" "),s("p",[t._v('[Service]\nType=forking\nEnvironment="JAVA_HOME=/usr/java/jdk1.8.0_231-amd64"\nEnvironment="PATH=$JAVA_HOME/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin"\nEnvironment="CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar"\nExecStart=/usr/local/tomcat/bin/startup.sh\nExecStop=/usr/local/tomcat/bin/shutdown.sh\nRestart=on-failure')]),t._v(" "),s("p",[t._v("[Install]\nWantedBy=multi-user.target\nsystemctl restart tomcat  #å¯åŠ¨\nsystemctl enable tomcat   #é…ç½®è‡ªå¯\nsystemctl stop  tomcat   #åœæ­¢æœåŠ¡\nsystemctl status  tomcat  #æ£€æµ‹çŠ¶æ€\nä»¥ä¸Šä¸¤ä¸ªå®žæˆ˜nginxå’Œtomcatç¨‹åºä¸­è‡ªå¸¦äº†å¯åŠ¨åœæ­¢è„šæœ¬ï¼Œå¦‚æžœå¯åŠ¨å¾—ç¨‹åºæ²¡æœ‰è‡ªå¸¦è„šæœ¬åˆ™éœ€è¦è‡ªå·±ç¼–å†™ä¸€ä¸ªç±»ä¼¼å¾—å¯åŠ¨åœæ­¢è„šæœ¬\nå®žæˆ˜ä¸‰\néƒ¨ç½²jarç¨‹åº å®žçŽ°systemdç®¡ç†æŽ§åˆ¶\nå®žé™…å¾—é¡¹ç›®ä¸­ä¼šæœ‰ä¸€äº›jarç¨‹åºéœ€è¦å¯åŠ¨ å¦‚æžœæ‰‹åŠ¨å¯åŠ¨åˆ™éœ€è¦è¾“å…¥ä¸€å¤§ä¸²å‘½ä»¤ åœæ­¢åˆ™éœ€è¦æ€æŽ‰è¿›ç¨‹æ¥åœæ­¢ï¼Œå¾ˆéº»çƒ¦\nä¸¾ä¸€ä¸ªå®žé™…å¯åŠ¨å¾—ä¾‹å­åˆ‡æ¢åˆ°jarç›®å½•ä¸‹\njava -jar decode.jar -Dconfig=/usr/local/abc/application.properties\nç¼–å†™ä¸€ä¸ªå¯åŠ¨è„šæœ¬")]),t._v(" "),s("p",[t._v("vim  demo.sh")]),t._v(" "),s("p",[t._v("#!/bin/bash")]),t._v(" "),s("h1",{attrs:{id:""}},[s("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),s("p",[t._v('source /etc/profile\njarName="abc-web.jar"\nworkDir="/usr/local/abc"')]),t._v(" "),s("p",[t._v("start(){\ncd ${workDir} && java -jar ${jarName} --spring.profiles.active=prod --server.port=9630 >uams.log 2>&1 &\n}")]),t._v(" "),s("p",[t._v('stop(){\nps -ef | grep -qP "(?<=-jar)\\s+${jarName}" && kill $(ps -ef | grep -P "(?<=-jar)\\s+${jarName}" | awk \'{print $2}\')\n}')]),t._v(" "),s("p",[t._v("case $1 in\nstart)\nstart\n;;\nstop)\nstop\n;;\nrestart)\nstop\nstart\n;;\nesac\nç¼–å†™ systemd é…ç½®æ–‡ä»¶\nvim  /usr/lib/systemd/system/abc.service")]),t._v(" "),s("p",[t._v("[Unit]\nDescription=uams server\nWants=network-online.target\nAfter=network.target")]),t._v(" "),s("p",[t._v("[Service]\nType=forking\nWorkingDirectory=/usr/local/abc/\nExecStart=/bin/bash uams.sh start\nExecStop=/bin/bash uams.sh stop\nExecReload=/bin/bash uams.sh restart\nRestart=on-failure")]),t._v(" "),s("p",[t._v("[Install]\nWantedBy=multi-user.target\nå¯åŠ¨abcæœåŠ¡")]),t._v(" "),s("p",[t._v("systemctl restart abc  #å¯åŠ¨\nsystemctl enable abc   #é…ç½®è‡ªå¯\nsystemctl stop  abc   #åœæ­¢æœåŠ¡\nsystemctl status  abc  #æ£€æµ‹çŠ¶æ€")]),t._v(" "),s("h2",{attrs:{id:"æŽ’é”™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æŽ’é”™"}},[t._v("#")]),t._v(" æŽ’é”™")]),t._v(" "),s("p",[t._v("é¦–å…ˆçœ‹ä¸€ä¸‹æœåŠ¡åˆ—è¡¨é‡Œæœ‰æ²¡æœ‰è¿™ä¸ªæœåŠ¡ï¼š")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("systemctl list-unit-files --type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("service\n")])])]),s("p",[t._v("å¦‚æžœæœ‰çš„è¯ï¼š")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("systemctl daemon-reload\n")])])]),s("p",[t._v("å³å¯")])])}),[],!1,null,null,null);n.default=a.exports}}]);